<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.doubleu.calender.mybatis.CalenderMapper">
	<insert id = 'insert' parameterType="com.doubleu.calender.vo.CalenderVo">
		INSERT ALL
		INTO CALENDER
			(calender_no,
			calender_start_year,
			calender_start_month,
			calender_start_day,
			calender_start_time,
			calender_start_minute,
			calender_end_year,
			calender_end_month,
			calender_end_day,
			calender_end_time,
			calender_end_minute,
			calender_type,
			calender_subject,
			calender_content, 
			calender_place, 
			calender_writer, 
			calender_group, 
			calender_time)
		values
			(seq_calender_no.nextval, 
			#{calenderStartYear}, 
			#{calenderStartMonth}, 
			#{calenderStartDay}, 
			#{calenderStartTime}, 
			#{calenderStartMinute}, 
			#{calenderEndYear}, 
			#{calenderEndMonth}, 
			#{calenderEndDay}, 
			#{calenderEndTime}, 
			#{calenderEndMinute}, 
			#{calenderType},
			#{calenderSubject}, 
			#{calenderContent}, 
			#{calenderPlace}, 
			#{calenderWriter}, 
			#{calenderGroup}, 
			SYSDATE)
			
			<if test="calPartiList != null">
				<foreach collection="calPartiList" item="parti">
					INTO calender_participtant
					(calender_parti_no,
					calender_no,
					calender_partiMember
					)
					values
					(CalenderpartiSeq(),
					seq_calender_no.currval,
					#{parti.calenderPartiMember})
				</foreach>
			</if>
			SELECT * FROM dual
	</insert>
	
	<select id = 'selectList' resultMap="ResultVo"  parameterType="com.doubleu.calender.vo.CalenderVo">
		SELECT * FROM CALENDER
	</select>
	
	<select id="selectPartiList" resultMap="partiList" parameterType="int">
		SELECT * FROM CALENDER_PARTICIPTANT where calender_no=#{_parameter}
	</select>
	
	<select id="selectOne" parameterType="int" resultMap="ResultVo" >
		SELECT * FROM CALENDER WHERE calender_no=#{_parameter}
	</select>
	
	
	<resultMap type="com.doubleu.calender.vo.CalenderVo" id="ResultVo">
		<result property="calenderNo" column="calender_no"/>
		<result property="calenderStartYear" column="calender_start_year"/>
		<result property="calenderStartMonth" column="calender_start_month"/>
		<result property="calenderStartDay" column="calender_start_day"/>
		<result property="calenderStartTime" column="calender_start_time"/>
		<result property="calenderStartMinute" column="calender_start_minute"/>
		<result property="calenderEndYear" column="calender_end_year"/>
		<result property="calenderEndMonth" column="calender_end_month"/>
		<result property="calenderEndDay" column="calender_end_day"/>
		<result property="calenderEndTime" column="calender_end_time"/>
		<result property="calenderEndMinute" column="calender_end_minute"/>
		<result property="calenderType" column="calender_type"/>
		<result property="calenderSubject" column="calender_subject"/>
		<result property="calenderContent" column="calender_content"/>
		<result property="calenderPlace" column="calender_place"/>
		<result property="calenderWriter" column="calender_writer"/>
		<result property="calenderGroup" column="calender_group"/>
		<result property="calenderTime" column="calender_time"/>
	</resultMap>
	
	<resultMap type="com.doubleu.calender.vo.CalenderParticiptant" id="partiList">
		<result property="calenderPartiNo" column="calender_parti_no"/>
		<result property="calenderNo" column="calender_no"/>
		<result property="calenderPartiMember" column="calender_partiMember"/>
	</resultMap>
</mapper>
