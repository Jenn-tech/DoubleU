<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.doubleu.market.mybatis.MarketMapper">
	<insert id = 'insert' parameterType="com.doubleu.market.vo.MarketVo">
		insert all
		into market(market_no, category_no, members_no, market_subject, market_price, market_account, market_doc, market_hit, market_date)
		values(market_seq.nextval, #{categoryNo}, #{membersNo}, #{marketSubject}, #{marketPrice},#{marketAccount}, #{marketDoc},#{marketHit},#{marketDate})
		<if test="attlist != null">
			<foreach collection="attlist" item="att">
				into market_files(files_no, market_no, files_sysfile, files_orifile)
				values (getMarketAttSeq(), market_seq.currval, #{att.sysFile, jdbcType=VARCHAR}, #{att.oriFile})
			</foreach>
		</if>
		select * from dual		
	</insert>
	
		<insert id="insert_att" parameterType="com.doubleu.market.vo.MarketVo" >
		INSERT ALL
		<foreach collection="attlist" item="att">
			INTO market_files(files_no, market_no, files_sysfile, files_orifile)
			VALUES (getMarketAttSeq(), ${marketNo}, #{att.sysFile}, #{att.oriFile})
		</foreach>
		SELECT * FROM dual
	</insert>
</mapper>


<!-- 사진업로드 오류 nested exception is org.apache.ibatis.type.TypeException: Could 
	not set parameters for mapping: ParameterMapping{property='__frch_att_0.sysFile', 
	mode=IN, javaType=class java.lang.String, jdbcType=null, numericScale=null, 
	resultMapId='null', jdbcTypeName='null', expression='null'}. Cause: org.apache.ibatis.type.TypeException: 
	Error setting null for parameter #9 with JdbcType OTHER . Try setting a different 
	JdbcType for this parameter or a different jdbcTypeForNull configuration 
	property. Cause: java.sql.SQLException: 부적합한 열 유형: 1111 -->